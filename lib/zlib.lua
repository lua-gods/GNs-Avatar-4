local a={}local b={}a.Deflate={}a.Zlib={}a.Library=b;function a.Deflate.Compress(c,d)return b:CompressDeflate(c,d)end;function a.Deflate.Decompress(e)return b:DecompressDeflate(e)end;function a.Zlib.Compress(c,d)return b:CompressZlib(c,d)end;function a.Zlib.Decompress(e)return b:DecompressZlib(e)end;do local f="1.0.2-release"local g="LibDeflate"local h=3;local i="LibDeflate "..f.." Copyright (C) 2018-2020 Haoqian He.".." Licensed under the zlib License"b={}b._VERSION=f;b._MAJOR=g;b._MINOR=h;b._COPYRIGHT=i end;local assert=assert;local error=error;local pairs=pairs;local j=string.byte;local k=string.char;local l=string.find;local m=string.gsub;local n=string.sub;local o=table.concat;local p=table.sort;local tostring=tostring;local type=type;local q={}local r={}local s={}local t={}local u={}local v={}local w={}local x={}local y={}local z={3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258}local A={0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0}local B={[0]=1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577}local C={[0]=0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13}local D={16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15}local E;local F;local G;local H;local I;local J;local K;local L;for M=0,255 do r[M]=k(M)end;do local N=1;for M=0,32 do q[M]=N;N=N*2 end end;for M=1,9 do s[M]={}for O=0,q[M+1]-1 do local P=0;local Q=O;for R=1,M do P=P-P%2+((P%2==1 or Q%2==1)and 1 or 0)Q=(Q-Q%2)/2;P=P*2 end;s[M][O]=(P-P%2)/2 end end;do local S=18;local T=16;local U=265;local V=1;for W=3,258 do if W<=10 then t[W]=W+254;v[W]=0 elseif W==258 then t[W]=285;v[W]=0 else if W>S then S=S+T;T=T*2;U=U+4;V=V+1 end;local X=W-S-1+T/2;t[W]=(X-X%(T/8))/(T/8)+U;v[W]=V;u[W]=X%(T/8)end end end;do w[1]=0;w[2]=1;y[1]=0;y[2]=0;local S=3;local T=4;local Y=2;local V=0;for Z=3,256 do if Z>T then S=S*2;T=T*2;Y=Y+2;V=V+1 end;w[Z]=Z<=S and Y or Y+1;y[Z]=V<0 and 0 or V;if T>=8 then x[Z]=(Z-T/2-1)%(T/4)end end end;function b:Adler32(_)if type(_)~="string"then error(("Usage: LibDeflate:Adler32(str):".." 'str' - string expected got '%s'."):format(type(_)),2)end;local a0=#_;local M=1;local S=1;local T=0;while M<=a0-15 do local a1,a2,a3,a4,a5,a6,a7,a8,a9,aa,ab,ac,ad,ae,af,ag=j(_,M,M+15)T=(T+16*S+16*a1+15*a2+14*a3+13*a4+12*a5+11*a6+10*a7+9*a8+8*a9+7*aa+6*ab+5*ac+4*ad+3*ae+2*af+ag)%65521;S=(S+a1+a2+a3+a4+a5+a6+a7+a8+a9+aa+ab+ac+ad+ae+af+ag)%65521;M=M+16 end;while M<=a0 do local ah=j(_,M,M)S=(S+ah)%65521;T=(T+S)%65521;M=M+1 end;return(T*65536+S)%4294967296 end;local function ai(aj,ak)return aj%4294967296==ak%4294967296 end;function b:CreateDictionary(_,a0,al)if type(_)~="string"then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'str' - string expected got '%s'."):format(type(_)),2)end;if type(a0)~="number"then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'strlen' - number expected got '%s'."):format(type(a0)),2)end;if type(al)~="number"then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'adler32' - number expected got '%s'."):format(type(al)),2)end;if a0~=#_ then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'strlen' does not match the actual length of 'str'.".." 'strlen': %u, '#str': %u .".." Please check if 'str' is modified unintentionally."):format(a0,#_))end;if a0==0 then error("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'str' - Empty string is not allowed.",2)end;if a0>32768 then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'str' - string longer than 32768 bytes is not allowed.".." Got %d bytes."):format(a0),2)end;local am=self:Adler32(_)if not ai(al,am)then error(("Usage: LibDeflate:CreateDictionary(str, strlen, adler32):".." 'adler32' does not match the actual adler32 of 'str'.".." 'adler32': %u, 'Adler32(str)': %u .".." Please check if 'str' is modified unintentionally."):format(al,am))end;local an={}an.adler32=al;an.hash_tables={}an.string_table={}an.strlen=a0;local ao=an.string_table;local ap=an.hash_tables;ao[1]=j(_,1,1)ao[2]=j(_,2,2)if a0>=3 then local M=1;local aq=ao[1]*256+ao[2]while M<=a0-2-3 do local a1,a2,a3,a4=j(_,M+2,M+5)ao[M+2]=a1;ao[M+3]=a2;ao[M+4]=a3;ao[M+5]=a4;aq=(aq*256+a1)%16777216;local X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=M-a0;M=M+1;aq=(aq*256+a2)%16777216;X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=M-a0;M=M+1;aq=(aq*256+a3)%16777216;X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=M-a0;M=M+1;aq=(aq*256+a4)%16777216;X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=M-a0;M=M+1 end;while M<=a0-2 do local ah=j(_,M+2)ao[M+2]=ah;aq=(aq*256+ah)%16777216;local X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=M-a0;M=M+1 end end;return an end;local function ar(an)if type(an)~="table"then return false,("'dictionary' - table expected got '%s'."):format(type(an))end;if type(an.adler32)~="number"or type(an.string_table)~="table"or type(an.strlen)~="number"or an.strlen<=0 or an.strlen>32768 or an.strlen~=#an.string_table or type(an.hash_tables)~="table"then return false,("'dictionary' - corrupted dictionary."):format(type(an))end;return true,""end;local as={[0]={false,nil,0,0,0},[1]={false,nil,4,8,4},[2]={false,nil,5,18,8},[3]={false,nil,6,32,32},[4]={true,4,4,16,16},[5]={true,8,16,32,32},[6]={true,8,16,128,128},[7]={true,8,32,128,256},[8]={true,32,128,258,1024},[9]={true,32,258,258,4096}}local function at(_,au,an,av,d)if type(_)~="string"then return false,("'str' - string expected got '%s'."):format(type(_))end;if au then local aw,ax=ar(an)if not aw then return false,ax end end;if av then local ay=type(d)if ay~="nil"and ay~="table"then return false,("'configs' - nil or table expected got '%s'."):format(type(d))end;if ay=="table"then for az,aA in pairs(d)do if az~="level"and az~="strategy"then return false,("'configs' - unsupported table key in the configs: '%s'."):format(az)elseif az=="level"and not as[aA]then return false,("'configs' - unsupported 'level': %s."):format(tostring(aA))elseif az=="strategy"and aA~="fixed"and aA~="huffman_only"and aA~="dynamic"then return false,("'configs' - unsupported 'strategy': '%s'."):format(tostring(aA))end end end end;return true,""end;local aB=0;local aC=1;local aD=2;local aE=3;local function aF()local aG=0;local aH=0;local aI=0;local aJ=0;local aK={}local aL={}local function aM(Q,V)aH=aH+Q*q[aI]aI=aI+V;aJ=aJ+V;if aI>=32 then aG=aG+1;aK[aG]=r[aH%256]..r[(aH-aH%256)/256%256]..r[(aH-aH%65536)/65536%256]..r[(aH-aH%16777216)/16777216%256]local aN=q[32-aI+V]aH=(Q-Q%aN)/aN;aI=aI-32 end end;local function aO(_)for R=1,aI,8 do aG=aG+1;aK[aG]=k(aH%256)aH=(aH-aH%256)/256 end;aI=0;aG=aG+1;aK[aG]=_;aJ=aJ+#_*8 end;local function aP(aQ)if aQ==aE then return aJ end;if aQ==aC or aQ==aD then local aR=(8-aI%8)%8;if aI>0 then aH=aH-q[aI]+q[aI+aR]for R=1,aI,8 do aG=aG+1;aK[aG]=r[aH%256]aH=(aH-aH%256)/256 end;aH=0;aI=0 end;if aQ==aD then aJ=aJ+aR;return aJ end end;local aS=o(aK)aK={}aG=0;aL[#aL+1]=aS;if aQ==aB then return aJ else return aJ,o(aL)end end;return aM,aO,aP end;local function aT(aU,aV,aW)aW=aW+1;aU[aW]=aV;local Q=aV[1]local aX=aW;local aY=(aX-aX%2)/2;while aY>=1 and aU[aY][1]>Q do local X=aU[aY]aU[aY]=aV;aU[aX]=X;aX=aY;aY=(aY-aY%2)/2 end end;local function aZ(aU,aW)local a_=aU[1]local aV=aU[aW]local Q=aV[1]aU[1]=aV;aU[aW]=a_;aW=aW-1;local aX=1;local b0=aX*2;local b1=b0+1;while b0<=aW do local b2=aU[b0]if b1<=aW and aU[b1][1]<b2[1]then local b3=aU[b1]if b3[1]<Q then aU[b1]=aV;aU[aX]=b3;aX=b1;b0=aX*2;b1=b0+1 else break end else if b2[1]<Q then aU[b0]=aV;aU[aX]=b2;aX=b0;b0=aX*2;b1=b0+1 else break end end end;return a_ end;local function b4(b5,b6,b7,b8)local b9=0;local ba={}local bb={}for V=1,b8 do b9=(b9+(b5[V-1]or 0))*2;ba[V]=b9 end;for bc=0,b7 do local V=b6[bc]if V then b9=ba[V]ba[V]=b9+1;if V<=9 then bb[bc]=s[V][b9]else local P=0;for R=1,V do P=P-P%2+((P%2==1 or b9%2==1)and 1 or 0)b9=(b9-b9%2)/2;P=P*2 end;bb[bc]=(P-P%2)/2 end end end;return bb end;local function bd(S,T)return S[1]<T[1]or S[1]==T[1]and S[2]<T[2]end;local function be(bf,b8,b7)local aW;local bg=-1;local bh={}local aU={}local b6={}local bi={}local b5={}local bj=0;for bc,bk in pairs(bf)do bj=bj+1;bh[bj]={bk,bc}end;if bj==0 then return{},{},-1 elseif bj==1 then local bc=bh[1][2]b6[bc]=1;bi[bc]=0;return b6,bi,bc else p(bh,bd)aW=bj;for M=1,aW do aU[M]=bh[M]end;while aW>1 do local bl=aZ(aU,aW)aW=aW-1;local bm=aZ(aU,aW)aW=aW-1;local bn={bl[1]+bm[1],-1,bl,bm}aT(aU,bn,aW)aW=aW+1 end;local bo=0;local bp={aU[1],0,0,0}local bq=1;local br=1;aU[1][1]=0;while br<=bq do local aV=bp[br]local V=aV[1]local bc=aV[2]local b2=aV[3]local b3=aV[4]if b2 then bq=bq+1;bp[bq]=b2;b2[1]=V+1 end;if b3 then bq=bq+1;bp[bq]=b3;b3[1]=V+1 end;br=br+1;if V>b8 then bo=bo+1;V=b8 end;if bc>=0 then b6[bc]=V;bg=bc>bg and bc or bg;b5[V]=(b5[V]or 0)+1 end end;if bo>0 then repeat local V=b8-1;while(b5[V]or 0)==0 do V=V-1 end;b5[V]=b5[V]-1;b5[V+1]=(b5[V+1]or 0)+2;b5[b8]=b5[b8]-1;bo=bo-2 until bo<=0;br=1;for V=b8,1,-1 do local bs=b5[V]or 0;while bs>0 do local bc=bh[br][2]b6[bc]=V;bs=bs-1;br=br+1 end end end;bi=b4(b5,b6,b7,b8)return b6,bi,bg end end;local function bt(bu,bv,bw,bx)local by=0;local bz={}local bA={}local bB=0;local bC={}local bD=nil;local bk=0;bx=bx<0 and 0 or bx;local bE=bv+bx+1;for Y=0,bE+1 do local W=Y<=bv and(bu[Y]or 0)or(Y<=bE and(bw[Y-bv-1]or 0)or nil)if W==bD then bk=bk+1;if W~=0 and bk==6 then by=by+1;bz[by]=16;bB=bB+1;bC[bB]=3;bA[16]=(bA[16]or 0)+1;bk=0 elseif W==0 and bk==138 then by=by+1;bz[by]=18;bB=bB+1;bC[bB]=127;bA[18]=(bA[18]or 0)+1;bk=0 end else if bk==1 then by=by+1;bz[by]=bD;bA[bD]=(bA[bD]or 0)+1 elseif bk==2 then by=by+1;bz[by]=bD;by=by+1;bz[by]=bD;bA[bD]=(bA[bD]or 0)+2 elseif bk>=3 then by=by+1;local bF=bD~=0 and 16 or(bk<=10 and 17 or 18)bz[by]=bF;bA[bF]=(bA[bF]or 0)+1;bB=bB+1;bC[bB]=bk<=10 and bk-3 or bk-11 end;bD=W;if W and W~=0 then by=by+1;bz[by]=W;bA[W]=(bA[W]or 0)+1;bk=0 else bk=1 end end end;return bz,bC,bA end;local function bG(_,X,bH,bI,bJ)local M=bH-bJ;while M<=bI-15-bJ do X[M],X[M+1],X[M+2],X[M+3],X[M+4],X[M+5],X[M+6],X[M+7],X[M+8],X[M+9],X[M+10],X[M+11],X[M+12],X[M+13],X[M+14],X[M+15]=j(_,M+bJ,M+15+bJ)M=M+16 end;while M<=bI-bJ do X[M]=j(_,M+bJ,M+bJ)M=M+1 end;return X end;local function bK(bL,ao,ap,bM,bN,bJ,an)local bO=as[bL]local bP,bQ,bR,bS,bT=bO[1],bO[2],bO[3],bO[4],bO[5]local bU=not bP and bR or 2147483646;local bV=bT-bT%4/4;local aq;local bW;local bX;local bY=0;if an then bW=an.hash_tables;bX=an.string_table;bY=an.strlen;assert(bM==1)if bN>=bM and bY>=2 then aq=bX[bY-1]*65536+bX[bY]*256+ao[1]local X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=-1 end;if bN>=bM+1 and bY>=1 then aq=bX[bY]*65536+ao[1]*256+ao[2]local X=ap[aq]if not X then X={}ap[aq]=X end;X[#X+1]=0 end end;local bZ=bY+3;aq=(ao[bM-bJ]or 0)*256+(ao[bM+1-bJ]or 0)local b_={}local c0=0;local c1={}local c2={}local c3=0;local c4={}local c5={}local c6=0;local c7={}local c8=0;local c9=false;local ca;local cb;local cc=0;local cd=0;local br=bM;local ce=bN+(bP and 1 or 0)while br<=ce do local cf=br-bJ;local cg=bJ-3;ca=cc;cb=cd;cc=0;aq=(aq*256+(ao[cf+2]or 0))%16777216;local ch;local ci;local cj=ap[aq]local ck;if not cj then ck=0;cj={}ap[aq]=cj;if bW then ci=bW[aq]ch=ci and#ci or 0 else ch=0 end else ck=#cj;ci=cj;ch=ck end;if br<=bN then cj[ck+1]=br end;if ch>0 and br+2<=bN and(not bP or ca<bR)then local cl=bP and ca>=bQ and bV or bT;local cm=bN-br;cm=cm>=257 and 257 or cm;cm=cm+cf;local cn=cf+3;while ch>=1 and cl>0 do local bD=ci[ch]if br-bD>32768 then break end;if bD<br then local co=cn;if bD>=-257 then local cp=bD-cg;while co<=cm and ao[cp]==ao[co]do co=co+1;cp=cp+1 end else local cp=bZ+bD;while co<=cm and bX[cp]==ao[co]do co=co+1;cp=cp+1 end end;local O=co-cf;if O>cc then cc=O;cd=br-bD end;if cc>=bS then break end end;ch=ch-1;cl=cl-1;if ch==0 and bD>0 and bW then ci=bW[aq]ch=ci and#ci or 0 end end end;if not bP then ca,cb=cc,cd end;if(not bP or c9)and(ca>3 or ca==3 and cb<4096)and cc<=ca then local Y=t[ca]local cq=v[ca]local cr,cs,ct;if cb<=256 then cr=w[cb]ct=x[cb]cs=y[cb]else cr=16;cs=7;local S=384;local T=512;while true do if cb<=S then ct=(cb-T/2-1)%(T/4)break elseif cb<=T then ct=(cb-T/2-1)%(T/4)cr=cr+1;break else cr=cr+2;cs=cs+1;S=S*2;T=T*2 end end end;c0=c0+1;b_[c0]=Y;c1[Y]=(c1[Y]or 0)+1;c3=c3+1;c2[c3]=cr;c4[cr]=(c4[cr]or 0)+1;if cq>0 then local cu=u[ca]c6=c6+1;c5[c6]=cu end;if cs>0 then c8=c8+1;c7[c8]=ct end;for M=br+1,br+ca-(bP and 2 or 1)do aq=(aq*256+(ao[M-bJ+2]or 0))%16777216;if ca<=bU then cj=ap[aq]if not cj then cj={}ap[aq]=cj end;cj[#cj+1]=M end end;br=br+ca-(bP and 1 or 0)c9=false elseif not bP or c9 then local Y=ao[bP and cf-1 or cf]c0=c0+1;b_[c0]=Y;c1[Y]=(c1[Y]or 0)+1;br=br+1 else c9=true;br=br+1 end end;c0=c0+1;b_[c0]=256;c1[256]=(c1[256]or 0)+1;return b_,c5,c1,c2,c7,c4 end;local function cv(c1,c4)local cw,cx,bv=be(c1,15,285)local cy,cz,bx=be(c4,15,29)local cA,bC,cB=bt(cw,bv,cy,bx)local cC,cD=be(cB,7,18)local cE=0;for M=1,19 do local bc=D[M]local cF=cC[bc]or 0;if cF~=0 then cE=M end end;cE=cE-4;local cG=bv+1-257;local cH=bx+1-1;if cH<0 then cH=0 end;return cG,cH,cE,cC,cD,cA,bC,cw,cx,cy,cz end;local function cI(b_,c2,cE,cC,cA,cw,cy)local cJ=17;cJ=cJ+(cE+4)*3;for M=1,#cA do local Y=cA[M]cJ=cJ+cC[Y]if Y>=16 then cJ=cJ+(Y==16 and 2 or(Y==17 and 3 or 7))end end;local cK=0;for M=1,#b_ do local Y=b_[M]local cL=cw[Y]cJ=cJ+cL;if Y>256 then cK=cK+1;if Y>264 and Y<285 then local cM=A[Y-256]cJ=cJ+cM end;local cr=c2[cK]local cN=cy[cr]cJ=cJ+cN;if cr>3 then local cs=(cr-cr%2)/2-1;cJ=cJ+cs end end end;return cJ end;local function cO(aM,cP,b_,c5,c2,c7,cG,cH,cE,cC,cD,cA,bC,cw,cx,cy,cz)aM(cP and 1 or 0,1)aM(2,2)aM(cG,5)aM(cH,5)aM(cE,4)for M=1,cE+4 do local bc=D[M]local cF=cC[bc]or 0;aM(cF,3)end;local cQ=1;for M=1,#cA do local Y=cA[M]aM(cD[Y],cC[Y])if Y>=16 then local cR=bC[cQ]aM(cR,Y==16 and 2 or(Y==17 and 3 or 7))cQ=cQ+1 end end;local cK=0;local cS=0;local cT=0;for M=1,#b_ do local cU=b_[M]local b9=cx[cU]local cL=cw[cU]aM(b9,cL)if cU>256 then cK=cK+1;if cU>264 and cU<285 then cS=cS+1;local cV=c5[cS]local cM=A[cU-256]aM(cV,cM)end;local cW=c2[cK]local cX=cz[cW]local cN=cy[cW]aM(cX,cN)if cW>3 then cT=cT+1;local ct=c7[cT]local cs=(cW-cW%2)/2-1;aM(ct,cs)end end end end;local function cY(b_,c2)local cJ=3;local cK=0;for M=1,#b_ do local Y=b_[M]local cL=G[Y]cJ=cJ+cL;if Y>256 then cK=cK+1;if Y>264 and Y<285 then local cM=A[Y-256]cJ=cJ+cM end;local cr=c2[cK]cJ=cJ+5;if cr>3 then local cs=(cr-cr%2)/2-1;cJ=cJ+cs end end end;return cJ end;local function cZ(aM,cP,b_,c5,c2,c7)aM(cP and 1 or 0,1)aM(1,2)local cK=0;local cS=0;local cT=0;for M=1,#b_ do local c_=b_[M]local b9=E[c_]local cL=G[c_]aM(b9,cL)if c_>256 then cK=cK+1;if c_>264 and c_<285 then cS=cS+1;local cV=c5[cS]local cM=A[c_-256]aM(cV,cM)end;local cr=c2[cK]local cX=I[cr]aM(cX,5)if cr>3 then cT=cT+1;local ct=c7[cT]local cs=(cr-cr%2)/2-1;aM(ct,cs)end end end end;local function d0(bM,bN,aJ)assert(bN-bM+1<=65535)local cJ=3;aJ=aJ+3;local aR=(8-aJ%8)%8;cJ=cJ+aR;cJ=cJ+32;cJ=cJ+(bN-bM+1)*8;return cJ end;local function d1(aM,aO,cP,_,bM,bN,aJ)assert(bN-bM+1<=65535)aM(cP and 1 or 0,1)aM(0,2)aJ=aJ+3;local aR=(8-aJ%8)%8;if aR>0 then aM(q[aR]-1,aR)end;local d2=bN-bM+1;aM(d2,16)local d3=255-d2%256+(255-(d2-d2%256)/256)*256;aM(d3,16)aO(_:sub(bM,bN))end;local function d4(d,aM,aO,aP,_,an)local ao={}local ap={}local cP=nil;local bM;local bN;local d5;local aJ=aP(aE)local a0=#_;local bJ;local bL;local d6;if d then if d.level then bL=d.level end;if d.strategy then d6=d.strategy end end;if not bL then if a0<2048 then bL=7 elseif a0>65536 then bL=3 else bL=5 end end;while not cP do if not bM then bM=1;bN=64*1024-1;bJ=0 else bM=bN+1;bN=bN+32*1024;bJ=bM-32*1024-1 end;if bN>=a0 then bN=a0;cP=true else cP=false end;local b_,c5,c1,c2,c7,c4;local cG,cH,cE,cC,cD,cA,bC,cw,cx,cy,cz;local d7;local d8;local d9;if bL~=0 then bG(_,ao,bM,bN+3,bJ)if bM==1 and an then local bX=an.string_table;local da=an.strlen;for M=0,-da+1<-257 and-257 or-da+1,-1 do ao[M]=bX[da+M]end end;if d6=="huffman_only"then b_={}bG(_,b_,bM,bN,bM-1)c5={}c1={}b_[bN-bM+2]=256;for M=1,bN-bM+2 do local Y=b_[M]c1[Y]=(c1[Y]or 0)+1 end;c2={}c7={}c4={}else b_,c5,c1,c2,c7,c4=bK(bL,ao,ap,bM,bN,bJ,an)end;cG,cH,cE,cC,cD,cA,bC,cw,cx,cy,cz=cv(c1,c4)d7=cI(b_,c2,cE,cC,cA,cw,cy)d8=cY(b_,c2)end;d9=d0(bM,bN,aJ)local db=d9;db=d8 and d8<db and d8 or db;db=d7 and d7<db and d7 or db;if bL==0 or d6~="fixed"and d6~="dynamic"and d9==db then d1(aM,aO,cP,_,bM,bN,aJ)aJ=aJ+d9 elseif d6~="dynamic"and(d6=="fixed"or d8==db)then cZ(aM,cP,b_,c5,c2,c7)aJ=aJ+d8 elseif d6=="dynamic"or d7==db then cO(aM,cP,b_,c5,c2,c7,cG,cH,cE,cC,cD,cA,bC,cw,cx,cy,cz)aJ=aJ+d7 end;if cP then d5=aP(aE)else d5=aP(aB)end;assert(d5==aJ)if not cP then local O;if an and bM==1 then O=0;while ao[O]do ao[O]=nil;O=O-1 end end;an=nil;O=1;for M=bN-32767,bN do ao[O]=ao[M-bJ]O=O+1 end;for az,X in pairs(ap)do local dc=#X;if dc>0 and bN+1-X[1]>32768 then if dc==1 then ap[az]=nil else local dd={}local de=0;for M=2,dc do O=X[M]if bN+1-O<=32768 then de=de+1;dd[de]=O end end;ap[az]=dd end end end end end end;local function df(_,an,d)local aM,aO,aP=aF()d4(d,aM,aO,aP,_,an)local aJ,dg=aP(aC)local aR=(8-aJ%8)%8;return dg,aR end;local function dh(_,an,d)local aM,aO,aP=aF()local di=8;local dj=7;local dk=dj*16+di;aM(dk,8)local dl=an and 1 or 0;local dm=2;local dn=dm*64+dl*32;local dp=31-(dk*256+dn)%31;dn=dn+dp;aM(dn,8)if dl==1 then local al=an.adler32;local dq=al%256;al=(al-dq)/256;local dr=al%256;al=(al-dr)/256;local ds=al%256;al=(al-ds)/256;local dt=al%256;aM(dt,8)aM(ds,8)aM(dr,8)aM(dq,8)end;d4(d,aM,aO,aP,_,an)aP(aD)local al=b:Adler32(_)local dt=al%256;al=(al-dt)/256;local ds=al%256;al=(al-ds)/256;local dr=al%256;al=(al-dr)/256;local dq=al%256;aM(dq,8)aM(dr,8)aM(ds,8)aM(dt,8)local aJ,dg=aP(aC)local aR=(8-aJ%8)%8;return dg,aR end;function b:CompressDeflate(_,d)local du,dv=at(_,false,nil,true,d)if not du then error("Usage: LibDeflate:CompressDeflate(str, configs): "..dv,2)end;return df(_,nil,d)end;function b:CompressDeflateWithDict(_,an,d)local du,dv=at(_,true,an,true,d)if not du then error("Usage: LibDeflate:CompressDeflateWithDict".."(str, dictionary, configs): "..dv,2)end;return df(_,an,d)end;function b:CompressZlib(_,d)local du,dv=at(_,false,nil,true,d)if not du then error("Usage: LibDeflate:CompressZlib(str, configs): "..dv,2)end;return dh(_,nil,d)end;function b:CompressZlibWithDict(_,an,d)local du,dv=at(_,true,an,true,d)if not du then error("Usage: LibDeflate:CompressZlibWithDict".."(str, dictionary, configs): "..dv,2)end;return dh(_,an,d)end;local function dw(dx)local dy=dx;local dz=#dx;local dA=1;local aI=0;local aH=0;local function dB(V)local aN=q[V]local Y;if V<=aI then Y=aH%aN;aH=(aH-Y)/aN;aI=aI-V else local dC=q[aI]local dr,ds,dt,dD=j(dy,dA,dA+3)aH=aH+((dr or 0)+(ds or 0)*256+(dt or 0)*65536+(dD or 0)*16777216)*dC;dA=dA+4;aI=aI+32-V;Y=aH%aN;aH=(aH-Y)/aN end;return Y end;local function dE(dF,aK,aG)assert(aI%8==0)local dG=aI/8<dF and aI/8 or dF;for R=1,dG do local dH=aH%256;aG=aG+1;aK[aG]=k(dH)aH=(aH-dH)/256 end;aI=aI-dG*8;dF=dF-dG;if(dz-dA-dF+1)*8+aI<0 then return-1 end;for M=dA,dA+dF-1 do aG=aG+1;aK[aG]=n(dy,M,M)end;dA=dA+dF;return aG end;local function dI(dJ,dK,db)local Y=0;local dL=0;local br=0;local bk;if db>0 then if aI<15 and dy then local dC=q[aI]local dr,ds,dt,dD=j(dy,dA,dA+3)aH=aH+((dr or 0)+(ds or 0)*256+(dt or 0)*65536+(dD or 0)*16777216)*dC;dA=dA+4;aI=aI+32 end;local aN=q[db]aI=aI-db;Y=aH%aN;aH=(aH-Y)/aN;Y=s[db][Y]bk=dJ[db]if Y<bk then return dK[Y]end;br=bk;dL=bk*2;Y=Y*2 end;for V=db+1,15 do local dM;dM=aH%2;aH=(aH-dM)/2;aI=aI-1;Y=dM==1 and Y+1-Y%2 or Y;bk=dJ[V]or 0;local dN=Y-dL;if dN<bk then return dK[br+dN]end;br=br+bk;dL=dL+bk;dL=dL*2;Y=Y*2 end;return-10 end;local function dO()return(dz-dA+1)*8+aI end;local function dP()local dQ=aI%8;local aN=q[dQ]aI=aI-dQ;aH=(aH-aH%aN)/aN end;return dB,dE,dI,dO,dP end;local function dR(_,an)local dB,dE,dI,dO,dP=dw(_)local dS={ReadBits=dB,ReadBytes=dE,Decode=dI,ReaderBitlenLeft=dO,SkipToByteBoundary=dP,buffer_size=0,buffer={},result_buffer={},dictionary=an}return dS end;local function dT(dU,b7,b8)local dJ={}local db=b8;for bc=0,b7 do local V=dU[bc]or 0;db=V>0 and V<db and V or db;dJ[V]=(dJ[V]or 0)+1 end;if dJ[0]==b7+1 then return 0,dJ,{},0 end;local dV=1;for W=1,b8 do dV=dV*2;dV=dV-(dJ[W]or 0)if dV<0 then return dV end end;local dW={}dW[1]=0;for W=1,b8-1 do dW[W+1]=dW[W]+(dJ[W]or 0)end;local dK={}for bc=0,b7 do local V=dU[bc]or 0;if V~=0 then local bJ=dW[V]dK[bJ]=bc;dW[V]=dW[V]+1 end end;return dV,dJ,dK,db end;local function dX(dS,cw,dY,dZ,cy,d_,e0)local aK,aG,dB,dI,dO,aL=dS.buffer,dS.buffer_size,dS.ReadBits,dS.Decode,dS.ReaderBitlenLeft,dS.result_buffer;local an=dS.dictionary;local bX;local da;local e1=1;if an and not aK[0]then bX=an.string_table;da=an.strlen;e1=-da+1;for M=0,-da+1<-257 and-257 or-da+1,-1 do aK[M]=r[bX[da+M]]end end;repeat local bc=dI(cw,dY,dZ)if bc<0 or bc>285 then return-10 elseif bc<256 then aG=aG+1;aK[aG]=r[bc]elseif bc>256 then bc=bc-256;local V=z[bc]V=bc>=8 and V+dB(A[bc])or V;bc=dI(cy,d_,e0)if bc<0 or bc>29 then return-10 end;local Z=B[bc]Z=Z>4 and Z+dB(C[bc])or Z;local e2=aG-Z+1;if e2<e1 then return-11 end;if e2>=-257 then for R=1,V do aG=aG+1;aK[aG]=aK[e2]e2=e2+1 end else e2=da+e2;for R=1,V do aG=aG+1;aK[aG]=r[bX[e2]]e2=e2+1 end end end;if dO()<0 then return 2 end;if aG>=65536 then aL[#aL+1]=o(aK,"",1,32768)for M=32769,aG do aK[M-32768]=aK[M]end;aG=aG-32768;aK[aG+1]=nil end until bc==256;dS.buffer_size=aG;return 0 end;local function e3(dS)local aK,aG,dB,dE,dO,dP,aL=dS.buffer,dS.buffer_size,dS.ReadBits,dS.ReadBytes,dS.ReaderBitlenLeft,dS.SkipToByteBoundary,dS.result_buffer;dP()local dF=dB(16)if dO()<0 then return 2 end;local e4=dB(16)if dO()<0 then return 2 end;if dF%256+e4%256~=255 then return-2 end;if(dF-dF%256)/256+(e4-e4%256)/256~=255 then return-2 end;aG=dE(dF,aK,aG)if aG<0 then return 2 end;if aG>=65536 then aL[#aL+1]=o(aK,"",1,32768)for M=32769,aG do aK[M-32768]=aK[M]end;aG=aG-32768;aK[aG+1]=nil end;dS.buffer_size=aG;return 0 end;local function e5(dS)return dX(dS,H,F,7,L,J,5)end;local function e6(dS)local dB,dI=dS.ReadBits,dS.Decode;local e7=dB(5)+257;local e8=dB(5)+1;local e9=dB(4)+4;if e7>286 or e8>30 then return-3 end;local cC={}for M=1,e9 do cC[D[M]]=dB(3)end;local ea,eb,ec,ed=dT(cC,18,7)if ea~=0 then return-4 end;local cw={}local cy={}local br=0;while br<e7+e8 do local bc;local V;bc=dI(eb,ec,ed)if bc<0 then return bc elseif bc<16 then if br<e7 then cw[br]=bc else cy[br-e7]=bc end;br=br+1 else V=0;if bc==16 then if br==0 then return-5 end;if br-1<e7 then V=cw[br-1]else V=cy[br-e7-1]end;bc=3+dB(2)elseif bc==17 then bc=3+dB(3)else bc=11+dB(7)end;if br+bc>e7+e8 then return-6 end;while bc>0 do bc=bc-1;if br<e7 then cw[br]=V else cy[br-e7]=V end;br=br+1 end end end;if(cw[256]or 0)==0 then return-9 end;local ee,ef,dY,dZ=dT(cw,e7-1,15)if ee~=0 and(ee<0 or e7~=(ef[0]or 0)+(ef[1]or 0))then return-7 end;local eg,eh,d_,e0=dT(cy,e8-1,15)if eg~=0 and(eg<0 or e8~=(eh[0]or 0)+(eh[1]or 0))then return-8 end;return dX(dS,ef,dY,dZ,eh,d_,e0)end;local function ei(dS)local dB=dS.ReadBits;local cP;while not cP do cP=dB(1)==1;local ej=dB(2)local ek;if ej==0 then ek=e3(dS)elseif ej==1 then ek=e5(dS)elseif ej==2 then ek=e6(dS)else return nil,-1 end;if ek~=0 then return nil,ek end end;dS.result_buffer[#dS.result_buffer+1]=o(dS.buffer,"",1,dS.buffer_size)local dg=o(dS.result_buffer)return dg end;local function el(_,an)local dS=dR(_,an)local dg,ek=ei(dS)if not dg then return nil,ek end;local em=dS.ReaderBitlenLeft()local en=(em-em%8)/8;return dg,en end;local function eo(_,an)local dS=dR(_,an)local dB=dS.ReadBits;local dk=dB(8)if dS.ReaderBitlenLeft()<0 then return nil,2 end;local di=dk%16;local dj=(dk-di)/16;if di~=8 then return nil,-12 end;if dj>7 then return nil,-13 end;local dn=dB(8)if dS.ReaderBitlenLeft()<0 then return nil,2 end;if(dk*256+dn)%31~=0 then return nil,-14 end;local dl=(dn-dn%32)/32%2;local dm=(dn-dn%64)/64%4;if dl==1 then if not an then return nil,-16 end;local dt=dB(8)local ds=dB(8)local dr=dB(8)local dq=dB(8)local am=dt*16777216+ds*65536+dr*256+dq;if dS.ReaderBitlenLeft()<0 then return nil,2 end;if not ai(am,an.adler32)then return nil,-17 end end;local dg,ek=ei(dS)if not dg then return nil,ek end;dS.SkipToByteBoundary()local ep=dB(8)local eq=dB(8)local er=dB(8)local es=dB(8)if dS.ReaderBitlenLeft()<0 then return nil,2 end;local et=ep*16777216+eq*65536+er*256+es;local eu=b:Adler32(dg)if not ai(et,eu)then return nil,-15 end;local em=dS.ReaderBitlenLeft()local en=(em-em%8)/8;return dg,en end;function b:DecompressDeflate(_)local du,dv=at(_)if not du then error("Usage: LibDeflate:DecompressDeflate(str): "..dv,2)end;return el(_)end;function b:DecompressDeflateWithDict(_,an)local du,dv=at(_,true,an)if not du then error("Usage: LibDeflate:DecompressDeflateWithDict(str, dictionary): "..dv,2)end;return el(_,an)end;function b:DecompressZlib(_)local du,dv=at(_)if not du then error("Usage: LibDeflate:DecompressZlib(str): "..dv,2)end;return eo(_)end;function b:DecompressZlibWithDict(_,an)local du,dv=at(_,true,an)if not du then error("Usage: LibDeflate:DecompressZlibWithDict(str, dictionary): "..dv,2)end;return eo(_,an)end;do G={}for ev=0,143 do G[ev]=8 end;for ev=144,255 do G[ev]=9 end;for ev=256,279 do G[ev]=7 end;for ev=280,287 do G[ev]=8 end;K={}for Z=0,31 do K[Z]=5 end;local ek;ek,H,F=dT(G,287,9)assert(ek==0)ek,L,J=dT(K,31,5)assert(ek==0)E=b4(H,G,287,9)I=b4(L,K,31,5)end;local ew={["\000"]="%z",["("]="%(",[")"]="%)",["."]="%.",["%"]="%%",["+"]="%+",["-"]="%-",["*"]="%*",["?"]="%?",["["]="%[",["]"]="%]",["^"]="%^",["$"]="%$"}local function ex(_)return _:gsub("([%z%(%)%.%%%+%-%*%?%[%]%^%$])",ew)end;function b:CreateCodec(ey,ez,eA)if type(ey)~="string"or type(ez)~="string"or type(eA)~="string"then error("Usage: LibDeflate:CreateCodec(reserved_chars,".." escape_chars, map_chars):".." All arguments must be string.",2)end;if ez==""then return nil,"No escape characters supplied."end;if#ey<#eA then return nil,"The number of reserved characters must be".." at least as many as the number of mapped chars."end;if ey==""then return nil,"No characters to encode."end;local eB=ey..ez..eA;local eC={}for M=1,#eB do local dH=j(eB,M,M)if eC[dH]then return nil,"There must be no duplicate characters in the".." concatenation of reserved_chars, escape_chars and".." map_chars."end;eC[dH]=true end;local eD={}local eE={}local eF={}local eG={}if#eA>0 then local eH={}local eI={}for M=1,#eA do local eJ=n(ey,M,M)local eK=n(eA,M,M)eG[eJ]=eK;eF[#eF+1]=eJ;eI[eK]=eJ;eH[#eH+1]=eK end;eD[#eD+1]="(["..ex(o(eH)).."])"eE[#eE+1]=eI end;local eL=1;local eM=n(ez,eL,eL)local eN=0;local eH={}local eI={}for M=1,#eB do local U=n(eB,M,M)if not eG[U]then while eN>=256 or eC[eN]do eN=eN+1;if eN>255 then eD[#eD+1]=ex(eM).."(["..ex(o(eH)).."])"eE[#eE+1]=eI;eL=eL+1;eM=n(ez,eL,eL)eN=0;eH={}eI={}if not eM or eM==""then return nil,"Out of escape characters."end end end;local eO=r[eN]eG[U]=eM..eO;eF[#eF+1]=U;eI[eO]=U;eH[#eH+1]=eO;eN=eN+1 end;if M==#eB then eD[#eD+1]=ex(eM).."(["..ex(o(eH)).."])"eE[#eE+1]=eI end end;local eP={}local eQ="(["..ex(o(eF)).."])"local eR=eG;function eP:Encode(_)if type(_)~="string"then error(("Usage: codec:Encode(str):".." 'str' - string expected got '%s'."):format(type(_)),2)end;return m(_,eQ,eR)end;local eS=#eD;local eT="(["..ex(ey).."])"function eP:Decode(_)if type(_)~="string"then error(("Usage: codec:Decode(str):".." 'str' - string expected got '%s'."):format(type(_)),2)end;if l(_,eT)then return nil end;for M=1,eS do _=m(_,eD[M],eE[M])end;return _ end;return eP end;local eU;local eV={[0]="a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","0","1","2","3","4","5","6","7","8","9","(",")"}local eW={[97]=0,[98]=1,[99]=2,[100]=3,[101]=4,[102]=5,[103]=6,[104]=7,[105]=8,[106]=9,[107]=10,[108]=11,[109]=12,[110]=13,[111]=14,[112]=15,[113]=16,[114]=17,[115]=18,[116]=19,[117]=20,[118]=21,[119]=22,[120]=23,[121]=24,[122]=25,[65]=26,[66]=27,[67]=28,[68]=29,[69]=30,[70]=31,[71]=32,[72]=33,[73]=34,[74]=35,[75]=36,[76]=37,[77]=38,[78]=39,[79]=40,[80]=41,[81]=42,[82]=43,[83]=44,[84]=45,[85]=46,[86]=47,[87]=48,[88]=49,[89]=50,[90]=51,[48]=52,[49]=53,[50]=54,[51]=55,[52]=56,[53]=57,[54]=58,[55]=59,[56]=60,[57]=61,[40]=62,[41]=63}function b:EncodeForPrint(_)if type(_)~="string"then error(("Usage: LibDeflate:EncodeForPrint(str):".." 'str' - string expected got '%s'."):format(type(_)),2)end;local a0=#_;local eX=a0-2;local M=1;local aK={}local aG=0;while M<=eX do local a1,a2,a3=j(_,M,M+2)M=M+3;local aH=a1+a2*256+a3*65536;local eY=aH%64;aH=(aH-eY)/64;local eZ=aH%64;aH=(aH-eZ)/64;local e_=aH%64;local f0=(aH-e_)/64;aG=aG+1;aK[aG]=eV[eY]..eV[eZ]..eV[e_]..eV[f0]end;local aH=0;local aI=0;while M<=a0 do local ah=j(_,M,M)aH=aH+ah*q[aI]aI=aI+8;M=M+1 end;while aI>0 do local f1=aH%64;aG=aG+1;aK[aG]=eV[f1]aH=(aH-f1)/64;aI=aI-6 end;return o(aK)end;function b:DecodeForPrint(_)if type(_)~="string"then error(("Usage: LibDeflate:DecodeForPrint(str):".." 'str' - string expected got '%s'."):format(type(_)),2)end;_=_:gsub("^[%c ]+","")_=_:gsub("[%c ]+$","")local a0=#_;if a0==1 then return nil end;local f2=a0-3;local M=1;local aK={}local aG=0;while M<=f2 do local a1,a2,a3,a4=j(_,M,M+3)a1=eW[a1]a2=eW[a2]a3=eW[a3]a4=eW[a4]if not(a1 and a2 and a3 and a4)then return nil end;M=M+4;local aH=a1+a2*64+a3*4096+a4*262144;local eY=aH%256;aH=(aH-eY)/256;local eZ=aH%256;local e_=(aH-eZ)/256;aG=aG+1;aK[aG]=r[eY]..r[eZ]..r[e_]end;local aH=0;local aI=0;while M<=a0 do local ah=j(_,M,M)ah=eW[ah]if not ah then return nil end;aH=aH+ah*q[aI]aI=aI+6;M=M+1 end;while aI>=8 do local dH=aH%256;aG=aG+1;aK[aG]=r[dH]aH=(aH-dH)/256;aI=aI-8 end;return o(aK)end;local function f3()eU=nil end;b.internals={LoadStringToTable=bG,IsValidDictionary=ar,IsEqualAdler32=ai,_byte_to_6bit_char=eV,_6bit_to_byte=eW,InternalClearCache=f3}return a