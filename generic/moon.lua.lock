local texture = textures["textures.moon"]

local pos = vec(512,0,1024)

local x,y,z,w = 0,0,0,31
local move = true

events.TICK:register(function()
	for i = 1, 64, 1 do
		local ppos = vec(x+z*32,100,y+w*32)
		local fpos = pos + ppos
		local height = math.floor(texture:getPixel(ppos.x,ppos.z).x*246) -128
		if move then
			move = false
			host:sendChatCommand("tp "..fpos.x.." 200 "..fpos.z)
		end
		--host:sendChatCommand("fill "..fpos.x.." 0 "..fpos.z.." "..fpos.x.." 255 "..fpos.z.." air")
		host:sendChatCommand("fill "..fpos.x.." 0 "..fpos.z.." "..fpos.x.." "..height.." "..fpos.z.." stone")
		x = x + 1
		if x >= 32 then
			x = 0
			y = y + 1
			if y >= 32 then
				y = 0
				z = z + 1
				move = true
				if z >= 32 then
					z = 0
					w = w + 1
				end
			end
		end
	end
end)